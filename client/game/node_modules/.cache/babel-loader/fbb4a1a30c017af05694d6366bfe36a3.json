{"ast":null,"code":"import _toConsumableArray from \"/home/robert/Desktop/codaisseur/week-7/Space-Game/client/game/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"/home/robert/Desktop/codaisseur/week-7/Space-Game/client/game/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/robert/Desktop/codaisseur/week-7/Space-Game/client/game/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/robert/Desktop/codaisseur/week-7/Space-Game/client/game/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/robert/Desktop/codaisseur/week-7/Space-Game/client/game/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/robert/Desktop/codaisseur/week-7/Space-Game/client/game/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/robert/Desktop/codaisseur/week-7/Space-Game/client/game/src/components/Game.js\";\nimport React, { Component } from \"react\";\nimport { Layer } from \"react-konva\";\nimport Field from \"./Field\";\nimport Ship from \"./Ship\";\nimport Bullet from \"./Bullet\";\nimport Konva from \"konva\";\nimport KeyHandler from \"react-key-handler\";\nimport io from \"socket.io-client\";\n\nvar Game =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Game, _Component);\n\n  function Game(props) {\n    var _this;\n\n    _classCallCheck(this, Game);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Game).call(this, props));\n    _this.keys = [\"w\", \"a\", \"s\", \"d\"];\n\n    _this.shootBullet = function (playerId, position) {\n      var newBullet = {\n        playerId: playerId,\n        id: Math.random(),\n        position: position\n      };\n\n      _this.setState({\n        bullets: [].concat(_toConsumableArray(_this.state.bullets), [newBullet])\n      });\n\n      setTimeout(function () {\n        return _this.removeBullet(newBullet.id);\n      }, 1000);\n    };\n\n    _this.removeBullet = function (bulletId) {\n      var newBulletArray = _this.state.bullets.filter(function (bullet) {\n        return bullet.id !== bulletId;\n      });\n\n      _this.setState({\n        bullets: newBulletArray\n      });\n    };\n\n    _this.handleKeyDown = function (event) {\n      switch (event.key) {\n        case \"w\":\n          _this.setState({\n            velocity: {\n              x: _this.state.velocity.x,\n              y: -3\n            }\n          });\n\n          break;\n\n        case \"s\":\n          _this.setState({\n            velocity: {\n              x: _this.state.velocity.x,\n              y: 3\n            }\n          });\n\n          break;\n\n        case \"a\":\n          _this.setState({\n            velocity: {\n              x: -3,\n              y: _this.state.velocity.y\n            }\n          });\n\n          break;\n\n        case \"d\":\n          _this.setState({\n            velocity: {\n              x: 3,\n              y: _this.state.velocity.y\n            }\n          });\n\n          break;\n\n        default:\n          console.log(\"down: \" + event.key);\n      }\n    };\n\n    _this.handleKeyUp = function (event) {\n      switch (event.key) {\n        case \"w\":\n          _this.setState({\n            velocity: {\n              x: _this.state.velocity.x,\n              y: 0\n            }\n          });\n\n          break;\n\n        case \"s\":\n          _this.setState({\n            velocity: {\n              x: _this.state.velocity.x,\n              y: 0\n            }\n          });\n\n          break;\n\n        case \"a\":\n          _this.setState({\n            velocity: {\n              x: 0,\n              y: _this.state.velocity.y\n            }\n          });\n\n          break;\n\n        case \"d\":\n          _this.setState({\n            velocity: {\n              x: 0,\n              y: _this.state.velocity.y\n            }\n          });\n\n          break;\n\n        default:\n          console.log(\"up: \" + event.key);\n      }\n    };\n\n    _this.state = {\n      velocity: {\n        x: 0,\n        y: 0\n      },\n      position: {\n        x: 0,\n        y: 0\n      },\n      players: [],\n      bullets: []\n    };\n    _this.socket = io(\"localhost:4000\");\n\n    _this.socket.emit(\"new player\");\n\n    setInterval(function () {\n      _this.socket.emit(\"movement\", _this.state);\n    }, 1000 / 60);\n\n    _this.socket.on(\"state\", function (players) {\n      _this.setState({\n        players: players\n      });\n    });\n\n    return _this;\n  }\n\n  _createClass(Game, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      return React.createElement(Layer, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 88\n        },\n        __self: this\n      }, React.createElement(Field, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 89\n        },\n        __self: this\n      }), Object.keys(this.state.players).map(function (player) {\n        return React.createElement(Ship, {\n          key: player,\n          player: player,\n          color: Konva.Util.getRandomColor(),\n          velocity: _this2.state.players[player].velocity,\n          socket: _this2.socket,\n          shootBullet: _this2.shootBullet,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 92\n          },\n          __self: this\n        });\n      }), this.state.bullets.map(function (bullet, index) {\n        return React.createElement(Bullet, {\n          player: bullet.playerId,\n          key: bullet.id,\n          color: \"red\",\n          velocity: {\n            x: 10,\n            y: 0\n          },\n          position: {},\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 103\n          },\n          __self: this\n        });\n      }), this.keys.map(function (key) {\n        return React.createElement(KeyHandler, {\n          keyEventName: \"keydown\",\n          key: key,\n          keyValue: key,\n          onKeyHandle: _this2.handleKeyDown,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 112\n          },\n          __self: this\n        });\n      }), this.keys.map(function (key) {\n        return React.createElement(KeyHandler, {\n          keyEventName: \"keyup\",\n          key: key,\n          keyValue: key,\n          onKeyHandle: _this2.handleKeyUp,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 120\n          },\n          __self: this\n        });\n      }));\n    }\n  }]);\n\n  return Game;\n}(Component);\n\nexport { Game as default };","map":{"version":3,"sources":["/home/robert/Desktop/codaisseur/week-7/Space-Game/client/game/src/components/Game.js"],"names":["React","Component","Layer","Field","Ship","Bullet","Konva","KeyHandler","io","Game","props","keys","shootBullet","playerId","position","newBullet","id","Math","random","setState","bullets","state","setTimeout","removeBullet","bulletId","newBulletArray","filter","bullet","handleKeyDown","event","key","velocity","x","y","console","log","handleKeyUp","players","socket","emit","setInterval","on","Object","map","player","Util","getRandomColor","index"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { Layer } from \"react-konva\";\nimport Field from \"./Field\";\nimport Ship from \"./Ship\";\nimport Bullet from \"./Bullet\";\nimport Konva from \"konva\";\nimport KeyHandler from \"react-key-handler\";\nimport io from \"socket.io-client\";\n\nexport default class Game extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      velocity: { x: 0, y: 0 },\n      position: { x: 0, y: 0 },\n      players: [],\n      bullets: []\n    };\n\n    this.socket = io(\"localhost:4000\");\n\n    this.socket.emit(\"new player\");\n    setInterval(() => {\n      this.socket.emit(\"movement\", this.state);\n    }, 1000 / 60);\n\n    this.socket.on(\"state\", players => {\n      this.setState({ players });\n    });\n  }\n\n  keys = [\"w\", \"a\", \"s\", \"d\"];\n\n  shootBullet = (playerId, position) => {\n    const newBullet = { playerId, id: Math.random(), position };\n    this.setState({ bullets: [...this.state.bullets, newBullet] });\n    setTimeout(() => this.removeBullet(newBullet.id), 1000);\n  };\n\n  removeBullet = bulletId => {\n    const newBulletArray = this.state.bullets.filter(\n      bullet => bullet.id !== bulletId\n    );\n    this.setState({ bullets: newBulletArray });\n  };\n\n  handleKeyDown = event => {\n    switch (event.key) {\n      case \"w\":\n        this.setState({ velocity: { x: this.state.velocity.x, y: -3 } });\n        break;\n      case \"s\":\n        this.setState({ velocity: { x: this.state.velocity.x, y: 3 } });\n        break;\n      case \"a\":\n        this.setState({ velocity: { x: -3, y: this.state.velocity.y } });\n        break;\n      case \"d\":\n        this.setState({ velocity: { x: 3, y: this.state.velocity.y } });\n        break;\n      default:\n        console.log(\"down: \" + event.key);\n    }\n  };\n\n  handleKeyUp = event => {\n    switch (event.key) {\n      case \"w\":\n        this.setState({ velocity: { x: this.state.velocity.x, y: 0 } });\n        break;\n      case \"s\":\n        this.setState({ velocity: { x: this.state.velocity.x, y: 0 } });\n        break;\n      case \"a\":\n        this.setState({ velocity: { x: 0, y: this.state.velocity.y } });\n        break;\n      case \"d\":\n        this.setState({ velocity: { x: 0, y: this.state.velocity.y } });\n        break;\n      default:\n        console.log(\"up: \" + event.key);\n    }\n  };\n\n  render() {\n    return (\n      <Layer>\n        <Field />\n        {Object.keys(this.state.players).map(player => {\n          return (\n            <Ship\n              key={player}\n              player={player}\n              color={Konva.Util.getRandomColor()}\n              velocity={this.state.players[player].velocity}\n              socket={this.socket}\n              shootBullet={this.shootBullet}\n            />\n          );\n        })}\n        {this.state.bullets.map((bullet, index) => (\n          <Bullet\n            player={bullet.playerId}\n            key={bullet.id}\n            color={\"red\"}\n            velocity={{ x: 10, y: 0 }}\n            position={{}}\n          />\n        ))}\n        {this.keys.map(key => (\n          <KeyHandler\n            keyEventName=\"keydown\"\n            key={key}\n            keyValue={key}\n            onKeyHandle={this.handleKeyDown}\n          />\n        ))}\n        {this.keys.map(key => (\n          <KeyHandler\n            keyEventName=\"keyup\"\n            key={key}\n            keyValue={key}\n            onKeyHandle={this.handleKeyUp}\n          />\n        ))}\n      </Layer>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}